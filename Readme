# ğŸ›’ E-Commerce API - NestJS

Una API REST robusta y escalable para e-commerce construida con **NestJS**, **TypeORM** y **PostgreSQL**. Implementa autenticaciÃ³n JWT, sistema de roles, validaciones avanzadas y gestiÃ³n completa de productos, usuarios y Ã³rdenes.

## ğŸš€ CaracterÃ­sticas Principales

- âœ… **Arquitectura Modular** con NestJS
- ğŸ” **AutenticaciÃ³n JWT** con sistema de roles
- ğŸ“Š **Base de Datos PostgreSQL** con TypeORM
- ğŸ›¡ï¸ **Validaciones Robustas** con class-validator
- ğŸ“ **GestiÃ³n de Archivos** con Cloudinary
- ğŸ“š **DocumentaciÃ³n AutomÃ¡tica** con Swagger
- ğŸ”’ **Guards de AutenticaciÃ³n y AutorizaciÃ³n**
- ğŸ”„ **Migraciones de Base de Datos**
- ğŸ“„ **PaginaciÃ³n** en consultas
- ğŸŒ± **Seeder de Datos** desde archivo JSON

## ğŸ› ï¸ Stack TecnolÃ³gico

| TecnologÃ­a | VersiÃ³n | PropÃ³sito |
|------------|---------|-----------|
| **NestJS** | 10.0 | Framework backend modular |
| **TypeScript** | 5.1.3 | Tipado estÃ¡tico |
| **TypeORM** | 0.3.20 | ORM para base de datos |
| **PostgreSQL** | - | Base de datos relacional |
| **JWT** | 10.2.0 | AutenticaciÃ³n stateless |
| **bcrypt** | 5.1.1 | Hash de contraseÃ±as |
| **Cloudinary** | 2.4.0 | GestiÃ³n de imÃ¡genes |
| **class-validator** | 0.14.1 | ValidaciÃ³n de DTOs |
| **Swagger** | 7.4.0 | DocumentaciÃ³n de API |

## ğŸ“‹ Modelo de Datos

### ğŸ‘¤ **Users**
```typescript
{
  id: UUID (PK)
  name: string (max 50)
  email: string (unique, max 50)
  password: string (hashed, max 120)
  phone: number
  country: string (max 50)
  address: text
  city: string (max 50)
  isAdmin: boolean (default: false)
  orders: Orders[] (relaciÃ³n 1:N)
}
```

### ğŸ“¦ **Products**
```typescript
{
  id: UUID (PK)
  name: string (unique, max 50)
  description: text
  price: decimal (10,2)
  stock: number
  imgUrl: text (default placeholder)
  category: Categories (relaciÃ³n N:1)
  orderDetails: OrderDetails[] (relaciÃ³n N:N)
}
```

### ğŸ·ï¸ **Categories**
```typescript
{
  id: UUID (PK)
  name: string (unique, max 50)
  products: Products[] (relaciÃ³n 1:N)
}
```

### ğŸ“‹ **Orders**
```typescript
{
  id: UUID (PK)
  date: Date
  user: Users (relaciÃ³n N:1)
  orderDetails: OrderDetails (relaciÃ³n 1:1)
}
```

### ğŸ“Š **OrderDetails**
```typescript
{
  id: UUID (PK)
  price: decimal (10,2)
  order: Orders (relaciÃ³n 1:1)
  products: Products[] (relaciÃ³n N:N)
}
```

## ğŸ”Œ Endpoints de la API

### ğŸ” **AutenticaciÃ³n** (`/auth`)

| MÃ©todo | Endpoint | DescripciÃ³n | AutorizaciÃ³n |
|--------|----------|-------------|--------------|
| `POST` | `/auth/signup` | Registro de usuario | PÃºblico |
| `POST` | `/auth/signin` | Inicio de sesiÃ³n | PÃºblico |
| `GET` | `/auth` | Test de conexiÃ³n | PÃºblico |

#### Ejemplo de Registro:
```json
{
  "name": "Juan PÃ©rez",
  "email": "juan@example.com",
  "password": "Password123!",
  "confirmPassword": "Password123!",
  "phone": 123456789,
  "country": "Chile",
  "address": "Av. Libertador 123",
  "city": "Santiago"
}
```

#### Ejemplo de Login:
```json
{
  "email": "juan@example.com",
  "password": "Password123!"
}
```

### ğŸ“¦ **Productos** (`/products`)

| MÃ©todo | Endpoint | DescripciÃ³n | AutorizaciÃ³n |
|--------|----------|-------------|--------------|
| `GET` | `/products?page=1&limit=5` | Lista productos con paginaciÃ³n | PÃºblico |
| `GET` | `/products/:id` | Obtener producto por ID | PÃºblico |
| `GET` | `/products/seeder` | Cargar productos desde JSON | PÃºblico |
| `PUT` | `/products/:id` | Actualizar producto | Admin + JWT |

## ğŸ”’ Sistema de Seguridad

### **Validaciones Implementadas:**

- **ContraseÃ±a Segura**: MÃ­nimo 8 caracteres, mayÃºsculas, minÃºsculas, nÃºmeros y sÃ­mbolos
- **Email Ãšnico**: VerificaciÃ³n en base de datos
- **ConfirmaciÃ³n de ContraseÃ±a**: Decorador personalizado `@MatchPassword`
- **ValidaciÃ³n de Campos**: Longitud mÃ­nima/mÃ¡xima, tipos de datos
- **UUIDs**: Identificadores Ãºnicos seguros

### **AutenticaciÃ³n JWT:**

- **Payload**: `{ id, email, isAdmin }`
- **ExpiraciÃ³n**: 1 hora
- **Algoritmo**: HS256
- **Guards**: AuthGuard y RolesGuard implementados

### **Sistema de Roles:**

- **Usuario Regular**: Acceso a endpoints pÃºblicos
- **Administrador**: Acceso completo a gestiÃ³n de productos

## âš™ï¸ ConfiguraciÃ³n e InstalaciÃ³n

### **Requisitos Previos:**
- Node.js 18+
- PostgreSQL
- Cuenta en Cloudinary (opcional)

### **Variables de Entorno (.env):**
```env
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=tu_usuario
DB_PASSWORD=tu_password
DB_NAME=ecomerce_db
JWT_SECRET=tu_jwt_secret_muy_seguro
CLOUDINARY_CLOUD_NAME=tu_cloud_name
CLOUDINARY_API_KEY=tu_api_key
CLOUDINARY_API_SECRET=tu_api_secret
```

### **InstalaciÃ³n:**
```bash
# Clonar repositorio
git clone https://github.com/ErickNoguera/Ecomerce-ErickNoguera.git
cd Ecomerce-ErickNoguera/back

# Instalar dependencias
npm install

# Configurar variables de entorno
cp .env.example .env
# Editar .env con tus credenciales

# Ejecutar migraciones
npm run migration:run

# Iniciar en desarrollo
npm run start:dev

# Iniciar en producciÃ³n
npm run build
npm run start:prod
```

## ğŸ“š DocumentaciÃ³n API

Una vez levantado el servidor, accede a la documentaciÃ³n interactiva de Swagger:

**URL**: `http://localhost:3000/api`

La documentaciÃ³n incluye:
- Esquemas de todos los DTOs
- Ejemplos de requests/responses
- CÃ³digos de estado HTTP
- Headers de autorizaciÃ³n requeridos

## ğŸ§ª Testing

```bash
# Tests unitarios
npm run test

# Tests con coverage
npm run test:cov

# Tests e2e
npm run test:e2e

# Tests en modo watch
npm run test:watch
```

## ğŸ“ Estructura del Proyecto

```
Ecomerce-ErickNoguera/
â”œâ”€â”€ src/                 # CÃ³digo fuente
â”‚   â”œâ”€â”€ auth/            # MÃ³dulo de autenticaciÃ³n
â”‚   â”‚   â”œâ”€â”€ guards/      # Guards de seguridad
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â””â”€â”€ auth.module.ts
â”‚   â”œâ”€â”€ users/           # MÃ³dulo de usuarios
â”‚   â”‚   â”œâ”€â”€ users.repository.ts
â”‚   â”‚   â”œâ”€â”€ user.dto.ts
â”‚   â”‚   â””â”€â”€ roles.enum.ts
â”‚   â”œâ”€â”€ products/        # MÃ³dulo de productos
â”‚   â”‚   â”œâ”€â”€ products.controller.ts
â”‚   â”‚   â”œâ”€â”€ products.service.ts
â”‚   â”‚   â”œâ”€â”€ products.repository.ts
â”‚   â”‚   â””â”€â”€ products.module.ts
â”‚   â”œâ”€â”€ categories/      # MÃ³dulo de categorÃ­as
â”‚   â”œâ”€â”€ orders/         # MÃ³dulo de Ã³rdenes
â”‚   â”œâ”€â”€ file-upload/    # MÃ³dulo de archivos
â”‚   â”œâ”€â”€ entities/       # Entidades TypeORM
â”‚   â”‚   â”œâ”€â”€ users.entity.ts
â”‚   â”‚   â”œâ”€â”€ products.entity.ts
â”‚   â”‚   â”œâ”€â”€ orders.entity.ts
â”‚   â”‚   â”œâ”€â”€ categories.entity.ts
â”‚   â”‚   â””â”€â”€ orderDetails.entity.ts
â”‚   â”œâ”€â”€ decorators/     # Decoradores personalizados
â”‚   â”‚   â”œâ”€â”€ roles.decorator.ts
â”‚   â”‚   â””â”€â”€ matchPassword.decorator.ts
â”‚   â”œâ”€â”€ config/         # Configuraciones
â”‚   â”‚   â””â”€â”€ typeorm.ts
â”‚   â”œâ”€â”€ middlewares/    # Middlewares
â”‚   â”‚   â””â”€â”€ loggerGlobal.ts
â”‚   â”œâ”€â”€ utils/          # Utilidades y seeds
â”‚   â”‚   â””â”€â”€ archivo.json
â”‚   â”œâ”€â”€ app.module.ts   # MÃ³dulo principal
â”‚   â””â”€â”€ main.ts        # Punto de entrada
â”œâ”€â”€ dist/              # CÃ³digo compilado
â”œâ”€â”€ node_modules/      # Dependencias
â”œâ”€â”€ test/             # Tests e2e
â”œâ”€â”€ .env              # Variables de entorno
â”œâ”€â”€ package.json      # ConfiguraciÃ³n del proyecto
â”œâ”€â”€ tsconfig.json     # ConfiguraciÃ³n TypeScript
â””â”€â”€ README.md         # DocumentaciÃ³n
```

## ğŸš€ CaracterÃ­sticas Avanzadas

### **Seeder de Datos:**
El endpoint `/products/seeder` carga productos desde `utils/archivo.json` utilizando `upsert` para evitar duplicados.

### **PaginaciÃ³n Implementada:**
```typescript
GET /products?page=1&limit=5
// Retorna productos de la pÃ¡gina especificada
```

### **Decorador Personalizado:**
```typescript
@Validate(MatchPassword, ['password'])
confirmPassword: string;
// Valida que confirmPassword coincida con password
```

### **Repository Pattern:**
SeparaciÃ³n clara entre controladores, servicios y repositorios para mejor mantenibilidad.

### **Middleware de Logging:**
Sistema personalizado de logging para todas las requests.

## ğŸ‘¨â€ğŸ’» Desarrollado por

**Erick Noguera**
- GitHub: [@ErickNoguera](https://github.com/ErickNoguera)
- LinkedIn: www.linkedin.com/in/erickyosethnogueraolaizola



---



## ğŸ¤ Contribuciones

Las contribuciones son bienvenidas. Para cambios importantes, abre primero un issue para discutir quÃ© te gustarÃ­a cambiar.

1. Fork el proyecto
2. Crea tu feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la branch (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

**â­ Si este proyecto te resultÃ³ Ãºtil, no olvides darle una estrella!**
